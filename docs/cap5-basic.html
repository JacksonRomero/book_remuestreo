<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5.2 Método percentil (básico) | Técnicas de Remuestreo</title>
  <meta name="description" content="Apuntes de la asignatura de Técnicas de Remuestreo del Máster en Técnicas Estadísticas." />
  <meta name="generator" content="bookdown 0.10 and GitBook 2.6.7" />

  <meta property="og:title" content="5.2 Método percentil (básico) | Técnicas de Remuestreo" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Apuntes de la asignatura de Técnicas de Remuestreo del Máster en Técnicas Estadísticas." />
  <meta name="github-repo" content="rubenfcasal/book_remuestreo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5.2 Método percentil (básico) | Técnicas de Remuestreo" />
  
  <meta name="twitter:description" content="Apuntes de la asignatura de Técnicas de Remuestreo del Máster en Técnicas Estadísticas." />
  

<meta name="author" content="Ricardo Cao Abad (rcao@udc.es) y Rubén Fernández Casal (ruben.fcasal@udc.es)" />


<meta name="date" content="2019-09-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="cap5-norm.html">
<link rel="next" href="cap5-perc-t.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Técnicas de Remuestreo</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prólogo</a></li>
<li class="chapter" data-level="1" data-path="cap1.html"><a href="cap1.html"><i class="fa fa-check"></i><b>1</b> Motivación del principio Bootstrap</a><ul>
<li class="chapter" data-level="1.1" data-path="introduccion.html"><a href="introduccion.html"><i class="fa fa-check"></i><b>1.1</b> Introducción</a><ul>
<li class="chapter" data-level="1.1.1" data-path="introduccion.html"><a href="introduccion.html#breve-nota-historica"><i class="fa fa-check"></i><b>1.1.1</b> Breve nota histórica</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduccion.html"><a href="introduccion.html#paradigma-inferencial-y-analogo-bootstrap"><i class="fa fa-check"></i><b>1.1.2</b> Paradigma inferencial y análogo bootstrap</a></li>
<li class="chapter" data-level="1.1.3" data-path="introduccion.html"><a href="introduccion.html#cap1-implementacion"><i class="fa fa-check"></i><b>1.1.3</b> Implementación en la práctica</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="cap1-unif.html"><a href="cap1-unif.html"><i class="fa fa-check"></i><b>1.2</b> El Bootstrap uniforme</a><ul>
<li class="chapter" data-level="1.2.1" data-path="cap1-unif.html"><a href="cap1-unif.html#ejemplos"><i class="fa fa-check"></i><b>1.2.1</b> Ejemplos</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="calculo-de-la-distribucion-bootstrap-exacta-y-aproximada.html"><a href="calculo-de-la-distribucion-bootstrap-exacta-y-aproximada.html"><i class="fa fa-check"></i><b>1.3</b> Cálculo de la distribución Bootstrap: exacta y aproximada</a><ul>
<li class="chapter" data-level="1.3.1" data-path="calculo-de-la-distribucion-bootstrap-exacta-y-aproximada.html"><a href="calculo-de-la-distribucion-bootstrap-exacta-y-aproximada.html#distribucion-bootstrap-exacta"><i class="fa fa-check"></i><b>1.3.1</b> Distribución bootstrap exacta</a></li>
<li class="chapter" data-level="1.3.2" data-path="calculo-de-la-distribucion-bootstrap-exacta-y-aproximada.html"><a href="calculo-de-la-distribucion-bootstrap-exacta-y-aproximada.html#vectores-de-remuestreo"><i class="fa fa-check"></i><b>1.3.2</b> Vectores de remuestreo</a></li>
<li class="chapter" data-level="1.3.3" data-path="calculo-de-la-distribucion-bootstrap-exacta-y-aproximada.html"><a href="calculo-de-la-distribucion-bootstrap-exacta-y-aproximada.html#inferencia-sobre-la-mediana"><i class="fa fa-check"></i><b>1.3.3</b> Inferencia sobre la mediana</a></li>
<li class="chapter" data-level="1.3.4" data-path="calculo-de-la-distribucion-bootstrap-exacta-y-aproximada.html"><a href="calculo-de-la-distribucion-bootstrap-exacta-y-aproximada.html#distribucion-bootstrap-aproximada-por-monte-carlo"><i class="fa fa-check"></i><b>1.3.4</b> Distribución Bootstrap aproximada por Monte Carlo</a></li>
<li class="chapter" data-level="1.3.5" data-path="calculo-de-la-distribucion-bootstrap-exacta-y-aproximada.html"><a href="calculo-de-la-distribucion-bootstrap-exacta-y-aproximada.html#eleccion-del-numero-de-replicas-monte-carlo"><i class="fa fa-check"></i><b>1.3.5</b> Elección del número de réplicas Monte Carlo</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="cap1-paquetes.html"><a href="cap1-paquetes.html"><i class="fa fa-check"></i><b>1.4</b> Herramientas disponibles en R sobre bootstrap</a><ul>
<li class="chapter" data-level="1.4.1" data-path="cap1-paquetes.html"><a href="cap1-paquetes.html#cap1-pkgboot"><i class="fa fa-check"></i><b>1.4.1</b> El paquete <code>boot</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="cap2.html"><a href="cap2.html"><i class="fa fa-check"></i><b>2</b> Estimación de la precisión y el sesgo de un estimador</a><ul>
<li class="chapter" data-level="2.1" data-path="cap2-boot.html"><a href="cap2-boot.html"><i class="fa fa-check"></i><b>2.1</b> Estimación bootstrap de la precisión y el sesgo de un estimador</a><ul>
<li class="chapter" data-level="2.1.1" data-path="cap2-boot.html"><a href="cap2-boot.html#ejemplo-la-media-muestral"><i class="fa fa-check"></i><b>2.1.1</b> Ejemplo: la media muestral</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="cap3.html"><a href="cap3.html"><i class="fa fa-check"></i><b>3</b> Motivación del método Jackknife</a><ul>
<li class="chapter" data-level="3.1" data-path="estimacion-jackknife-de-la-precision-y-el-sesgo-de-un-estimador.html"><a href="estimacion-jackknife-de-la-precision-y-el-sesgo-de-un-estimador.html"><i class="fa fa-check"></i><b>3.1</b> Estimación Jackknife de la precisión y el sesgo de un estimador</a></li>
<li class="chapter" data-level="3.2" data-path="relacion-bootstrapjackknife-en-dicha-estimacion.html"><a href="relacion-bootstrapjackknife-en-dicha-estimacion.html"><i class="fa fa-check"></i><b>3.2</b> Relación Bootstrap/Jackknife en dicha estimación</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="cap4.html"><a href="cap4.html"><i class="fa fa-check"></i><b>4</b> Modificaciones del Bootstrap uniforme</a><ul>
<li class="chapter" data-level="4.1" data-path="cap4-boot-par.html"><a href="cap4-boot-par.html"><i class="fa fa-check"></i><b>4.1</b> Bootstrap paramétrico</a></li>
<li class="chapter" data-level="4.2" data-path="bootstrap-simetrizado.html"><a href="bootstrap-simetrizado.html"><i class="fa fa-check"></i><b>4.2</b> Bootstrap simetrizado</a></li>
<li class="chapter" data-level="4.3" data-path="cap4-boot-suav.html"><a href="cap4-boot-suav.html"><i class="fa fa-check"></i><b>4.3</b> Bootstrap suavizado</a></li>
<li class="chapter" data-level="4.4" data-path="bootstrap-ponderado-y-bootstrap-sesgado.html"><a href="bootstrap-ponderado-y-bootstrap-sesgado.html"><i class="fa fa-check"></i><b>4.4</b> Bootstrap ponderado y bootstrap sesgado</a></li>
<li class="chapter" data-level="4.5" data-path="deficiencias-del-bootstrap-uniforme.html"><a href="deficiencias-del-bootstrap-uniforme.html"><i class="fa fa-check"></i><b>4.5</b> Deficiencias del bootstrap uniforme</a><ul>
<li class="chapter" data-level="4.5.1" data-path="deficiencias-del-bootstrap-uniforme.html"><a href="deficiencias-del-bootstrap-uniforme.html#ejemplo-metodo-alternativo"><i class="fa fa-check"></i><b>4.5.1</b> Ejemplo (método alternativo)</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="validez-de-la-aproximacion-bootstrap.html"><a href="validez-de-la-aproximacion-bootstrap.html"><i class="fa fa-check"></i><b>4.6</b> Validez de la aproximación Bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="cap5.html"><a href="cap5.html"><i class="fa fa-check"></i><b>5</b> Intervalos de confianza bootstrap</a><ul>
<li class="chapter" data-level="5.1" data-path="cap5-norm.html"><a href="cap5-norm.html"><i class="fa fa-check"></i><b>5.1</b> Intervalos basados en la distribución normal asintótica</a></li>
<li class="chapter" data-level="5.2" data-path="cap5-basic.html"><a href="cap5-basic.html"><i class="fa fa-check"></i><b>5.2</b> Método percentil (básico)</a></li>
<li class="chapter" data-level="5.3" data-path="cap5-perc-t.html"><a href="cap5-perc-t.html"><i class="fa fa-check"></i><b>5.3</b> Método percentil-<em>t</em></a></li>
<li class="chapter" data-level="5.4" data-path="cap5-perc-t-sim.html"><a href="cap5-perc-t-sim.html"><i class="fa fa-check"></i><b>5.4</b> Método percentil-<em>t</em> simetrizado</a></li>
<li class="chapter" data-level="5.5" data-path="cap5-err-cober.html"><a href="cap5-err-cober.html"><i class="fa fa-check"></i><b>5.5</b> Tabla resumen de los errores de cobertura</a></li>
<li class="chapter" data-level="5.6" data-path="cap5-ejem.html"><a href="cap5-ejem.html"><i class="fa fa-check"></i><b>5.6</b> Ejemplos</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="cap6.html"><a href="cap6.html"><i class="fa fa-check"></i><b>6</b> Bootstrap y estimación no paramétrica de la densidad</a><ul>
<li class="chapter" data-level="6.1" data-path="estimacion-no-parametrica-de-la-funcion-de-densidad.html"><a href="estimacion-no-parametrica-de-la-funcion-de-densidad.html"><i class="fa fa-check"></i><b>6.1</b> Estimación no paramétrica de la función de densidad</a></li>
<li class="chapter" data-level="6.2" data-path="sesgo-varianza-y-error-cuadratico-medio.html"><a href="sesgo-varianza-y-error-cuadratico-medio.html"><i class="fa fa-check"></i><b>6.2</b> Sesgo, varianza y error cuadrático medio</a><ul>
<li class="chapter" data-level="6.2.1" data-path="sesgo-varianza-y-error-cuadratico-medio.html"><a href="sesgo-varianza-y-error-cuadratico-medio.html#sesgo"><i class="fa fa-check"></i><b>6.2.1</b> Sesgo</a></li>
<li class="chapter" data-level="6.2.2" data-path="sesgo-varianza-y-error-cuadratico-medio.html"><a href="sesgo-varianza-y-error-cuadratico-medio.html#varianza"><i class="fa fa-check"></i><b>6.2.2</b> Varianza</a></li>
<li class="chapter" data-level="6.2.3" data-path="sesgo-varianza-y-error-cuadratico-medio.html"><a href="sesgo-varianza-y-error-cuadratico-medio.html#error-cuadratico-medio"><i class="fa fa-check"></i><b>6.2.3</b> Error cuadrático medio</a></li>
<li class="chapter" data-level="6.2.4" data-path="sesgo-varianza-y-error-cuadratico-medio.html"><a href="sesgo-varianza-y-error-cuadratico-medio.html#error-cuadratico-medio-integrado-mise"><i class="fa fa-check"></i><b>6.2.4</b> Error cuadrático medio integrado (MISE)</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="aproximacion-bootstrap-de-la-distribucion-del-estimador-de-parzen-rosenblatt.html"><a href="aproximacion-bootstrap-de-la-distribucion-del-estimador-de-parzen-rosenblatt.html"><i class="fa fa-check"></i><b>6.3</b> Aproximación Bootstrap de la distribución del estimador de Parzen-Rosenblatt</a><ul>
<li class="chapter" data-level="6.3.1" data-path="aproximacion-bootstrap-de-la-distribucion-del-estimador-de-parzen-rosenblatt.html"><a href="aproximacion-bootstrap-de-la-distribucion-del-estimador-de-parzen-rosenblatt.html#distribucion-asintotica-del-estimador-de-parzen-rosenblatt"><i class="fa fa-check"></i><b>6.3.1</b> Distribución asintótica del estimador de Parzen-Rosenblatt</a></li>
<li class="chapter" data-level="6.3.2" data-path="aproximacion-bootstrap-de-la-distribucion-del-estimador-de-parzen-rosenblatt.html"><a href="aproximacion-bootstrap-de-la-distribucion-del-estimador-de-parzen-rosenblatt.html#aproximacion-plug-in"><i class="fa fa-check"></i><b>6.3.2</b> Aproximación plug-in</a></li>
<li class="chapter" data-level="6.3.3" data-path="aproximacion-bootstrap-de-la-distribucion-del-estimador-de-parzen-rosenblatt.html"><a href="aproximacion-bootstrap-de-la-distribucion-del-estimador-de-parzen-rosenblatt.html#aproximacion-bootstrap"><i class="fa fa-check"></i><b>6.3.3</b> Aproximación bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="el-bootstrap-en-la-seleccion-del-parametro-de-suavizado-.html"><a href="el-bootstrap-en-la-seleccion-del-parametro-de-suavizado-.html"><i class="fa fa-check"></i><b>6.4</b> El Bootstrap en la selección del parámetro de suavizado.</a><ul>
<li class="chapter" data-level="6.4.1" data-path="el-bootstrap-en-la-seleccion-del-parametro-de-suavizado-.html"><a href="el-bootstrap-en-la-seleccion-del-parametro-de-suavizado-.html#expresion-asintotica-de-la-ventana-optima"><i class="fa fa-check"></i><b>6.4.1</b> Expresión asintótica de la ventana óptima</a></li>
<li class="chapter" data-level="6.4.2" data-path="el-bootstrap-en-la-seleccion-del-parametro-de-suavizado-.html"><a href="el-bootstrap-en-la-seleccion-del-parametro-de-suavizado-.html#analogo-bootstrap-del-mise"><i class="fa fa-check"></i><b>6.4.2</b> Análogo bootstrap del <span class="math inline">\(MISE\)</span></a></li>
<li class="chapter" data-level="6.4.3" data-path="el-bootstrap-en-la-seleccion-del-parametro-de-suavizado-.html"><a href="el-bootstrap-en-la-seleccion-del-parametro-de-suavizado-.html#expresion-cerrada-para-miseast"><i class="fa fa-check"></i><b>6.4.3</b> Expresión cerrada para <span class="math inline">\(MISE^{\ast}\)</span></a></li>
<li class="chapter" data-level="6.4.4" data-path="el-bootstrap-en-la-seleccion-del-parametro-de-suavizado-.html"><a href="el-bootstrap-en-la-seleccion-del-parametro-de-suavizado-.html#eleccion-de-la-ventana-piloto"><i class="fa fa-check"></i><b>6.4.4</b> Elección de la ventana piloto</a></li>
<li class="chapter" data-level="6.4.5" data-path="el-bootstrap-en-la-seleccion-del-parametro-de-suavizado-.html"><a href="el-bootstrap-en-la-seleccion-del-parametro-de-suavizado-.html#resultados-teoricos"><i class="fa fa-check"></i><b>6.4.5</b> Resultados teóricos</a></li>
<li class="chapter" data-level="6.4.6" data-path="el-bootstrap-en-la-seleccion-del-parametro-de-suavizado-.html"><a href="el-bootstrap-en-la-seleccion-del-parametro-de-suavizado-.html#caso-particular-de-nucleo-gaussiano"><i class="fa fa-check"></i><b>6.4.6</b> Caso particular de núcleo gaussiano</a></li>
<li class="chapter" data-level="6.4.7" data-path="el-bootstrap-en-la-seleccion-del-parametro-de-suavizado-.html"><a href="el-bootstrap-en-la-seleccion-del-parametro-de-suavizado-.html#comparacion-con-otros-selectores"><i class="fa fa-check"></i><b>6.4.7</b> Comparación con otros selectores</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="cap7.html"><a href="cap7.html"><i class="fa fa-check"></i><b>7</b> Bootstrap y regresión no paramétrica</a><ul>
<li class="chapter" data-level="7.1" data-path="estimacion-no-parametrica-de-la-funcion-de-regresion.html"><a href="estimacion-no-parametrica-de-la-funcion-de-regresion.html"><i class="fa fa-check"></i><b>7.1</b> Estimación no paramétrica de la función de regresión</a><ul>
<li class="chapter" data-level="7.1.1" data-path="estimacion-no-parametrica-de-la-funcion-de-regresion.html"><a href="estimacion-no-parametrica-de-la-funcion-de-regresion.html#distribucion-asintotica-del-estimador-de-nadaraya-watson"><i class="fa fa-check"></i><b>7.1.1</b> Distribución asintótica del estimador de Nadaraya-Watson</a></li>
<li class="chapter" data-level="7.1.2" data-path="estimacion-no-parametrica-de-la-funcion-de-regresion.html"><a href="estimacion-no-parametrica-de-la-funcion-de-regresion.html#ordenes-de-convergencia-de-la-distribucion-del-estimador-de-nadaraya-watson-a-su-distribucion-asintotica"><i class="fa fa-check"></i><b>7.1.2</b> Órdenes de convergencia de la distribución del estimador de Nadaraya-Watson a su distribución asintótica</a></li>
<li class="chapter" data-level="7.1.3" data-path="estimacion-no-parametrica-de-la-funcion-de-regresion.html"><a href="estimacion-no-parametrica-de-la-funcion-de-regresion.html#aproximacion-plug-in-1"><i class="fa fa-check"></i><b>7.1.3</b> Aproximación plug-in</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="distintos-metodos-de-remuestreo-y-resultados-para-ellos.html"><a href="distintos-metodos-de-remuestreo-y-resultados-para-ellos.html"><i class="fa fa-check"></i><b>7.2</b> Distintos métodos de remuestreo y resultados para ellos</a><ul>
<li class="chapter" data-level="7.2.1" data-path="distintos-metodos-de-remuestreo-y-resultados-para-ellos.html"><a href="distintos-metodos-de-remuestreo-y-resultados-para-ellos.html#wild-bootstrap"><i class="fa fa-check"></i><b>7.2.1</b> Wild bootstrap</a></li>
<li class="chapter" data-level="7.2.2" data-path="distintos-metodos-de-remuestreo-y-resultados-para-ellos.html"><a href="distintos-metodos-de-remuestreo-y-resultados-para-ellos.html#bootstrap-suavizado-en-la-variable-explicativa"><i class="fa fa-check"></i><b>7.2.2</b> Bootstrap suavizado en la variable explicativa</a></li>
<li class="chapter" data-level="7.2.3" data-path="distintos-metodos-de-remuestreo-y-resultados-para-ellos.html"><a href="distintos-metodos-de-remuestreo-y-resultados-para-ellos.html#resumen-comparativo"><i class="fa fa-check"></i><b>7.2.3</b> Resumen comparativo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="cap8.html"><a href="cap8.html"><i class="fa fa-check"></i><b>8</b> El Bootstrap con datos censurados</a><ul>
<li class="chapter" data-level="8.1" data-path="introduccion-a-los-datos-censurados.html"><a href="introduccion-a-los-datos-censurados.html"><i class="fa fa-check"></i><b>8.1</b> Introducción a los datos censurados</a><ul>
<li class="chapter" data-level="8.1.1" data-path="introduccion-a-los-datos-censurados.html"><a href="introduccion-a-los-datos-censurados.html#estimador-de-kaplan-meier"><i class="fa fa-check"></i><b>8.1.1</b> Estimador de Kaplan-Meier</a></li>
<li class="chapter" data-level="8.1.2" data-path="introduccion-a-los-datos-censurados.html"><a href="introduccion-a-los-datos-censurados.html#distribucion-asintotica-del-estimador-de-kaplan-meier"><i class="fa fa-check"></i><b>8.1.2</b> Distribución asintótica del estimador de Kaplan-Meier</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="remuestreos-bootstrap-en-presencia-de-censura.html"><a href="remuestreos-bootstrap-en-presencia-de-censura.html"><i class="fa fa-check"></i><b>8.2</b> Remuestreos Bootstrap en presencia de censura</a><ul>
<li class="chapter" data-level="8.2.1" data-path="remuestreos-bootstrap-en-presencia-de-censura.html"><a href="remuestreos-bootstrap-en-presencia-de-censura.html#el-bootstrap-simple"><i class="fa fa-check"></i><b>8.2.1</b> El bootstrap simple</a></li>
<li class="chapter" data-level="8.2.2" data-path="remuestreos-bootstrap-en-presencia-de-censura.html"><a href="remuestreos-bootstrap-en-presencia-de-censura.html#cap8-obvio"><i class="fa fa-check"></i><b>8.2.2</b> El bootstrap obvio</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="relaciones-entre-los-metodos-de-remuestreo-bajo-censura.html"><a href="relaciones-entre-los-metodos-de-remuestreo-bajo-censura.html"><i class="fa fa-check"></i><b>8.3</b> Relaciones entre los métodos de remuestreo bajo censura</a><ul>
<li class="chapter" data-level="8.3.1" data-path="relaciones-entre-los-metodos-de-remuestreo-bajo-censura.html"><a href="relaciones-entre-los-metodos-de-remuestreo-bajo-censura.html#equivalencia-entre-el-bootstrap-simple-y-el-obvio"><i class="fa fa-check"></i><b>8.3.1</b> Equivalencia entre el bootstrap simple y el obvio</a></li>
<li class="chapter" data-level="8.3.2" data-path="relaciones-entre-los-metodos-de-remuestreo-bajo-censura.html"><a href="relaciones-entre-los-metodos-de-remuestreo-bajo-censura.html#cap8-reid"><i class="fa fa-check"></i><b>8.3.2</b> El bootstrap de Reid</a></li>
<li class="chapter" data-level="8.3.3" data-path="relaciones-entre-los-metodos-de-remuestreo-bajo-censura.html"><a href="relaciones-entre-los-metodos-de-remuestreo-bajo-censura.html#validez-de-los-planes-de-remuestreo"><i class="fa fa-check"></i><b>8.3.3</b> Validez de los planes de remuestreo</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="implementacion-en-r-con-los-paquetes-boot-y-survival.html"><a href="implementacion-en-r-con-los-paquetes-boot-y-survival.html"><i class="fa fa-check"></i><b>8.4</b> Implementación en <code>R</code> (con los paquetes <code>boot</code> y <code>survival</code>)</a><ul>
<li class="chapter" data-level="8.4.1" data-path="implementacion-en-r-con-los-paquetes-boot-y-survival.html"><a href="implementacion-en-r-con-los-paquetes-boot-y-survival.html#bootstrap-simple"><i class="fa fa-check"></i><b>8.4.1</b> Bootstrap simple</a></li>
<li class="chapter" data-level="8.4.2" data-path="implementacion-en-r-con-los-paquetes-boot-y-survival.html"><a href="implementacion-en-r-con-los-paquetes-boot-y-survival.html#otros-metodos-de-remuestreo"><i class="fa fa-check"></i><b>8.4.2</b> Otros métodos de remuestreo</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="ejercicios.html"><a href="ejercicios.html"><i class="fa fa-check"></i><b>8.5</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="cap9.html"><a href="cap9.html"><i class="fa fa-check"></i><b>9</b> El Bootstrap con datos dependientes</a><ul>
<li class="chapter" data-level="9.1" data-path="introduccion-a-las-condiciones-de-dependencia-y-modelos-habituales-de-datos-dependientes.html"><a href="introduccion-a-las-condiciones-de-dependencia-y-modelos-habituales-de-datos-dependientes.html"><i class="fa fa-check"></i><b>9.1</b> Introducción a las condiciones de dependencia y modelos habituales de datos dependientes</a><ul>
<li class="chapter" data-level="9.1.1" data-path="introduccion-a-las-condiciones-de-dependencia-y-modelos-habituales-de-datos-dependientes.html"><a href="introduccion-a-las-condiciones-de-dependencia-y-modelos-habituales-de-datos-dependientes.html#situaciones-de-dependencia-general"><i class="fa fa-check"></i><b>9.1.1</b> Situaciones de dependencia general</a></li>
<li class="chapter" data-level="9.1.2" data-path="introduccion-a-las-condiciones-de-dependencia-y-modelos-habituales-de-datos-dependientes.html"><a href="introduccion-a-las-condiciones-de-dependencia-y-modelos-habituales-de-datos-dependientes.html#modelos-parametricos-de-dependencia"><i class="fa fa-check"></i><b>9.1.2</b> Modelos paramétricos de dependencia</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="el-bootstrap-en-la-estimacion-con-datos-dependientes.html"><a href="el-bootstrap-en-la-estimacion-con-datos-dependientes.html"><i class="fa fa-check"></i><b>9.2</b> El bootstrap en la estimación con datos dependientes</a><ul>
<li class="chapter" data-level="9.2.1" data-path="el-bootstrap-en-la-estimacion-con-datos-dependientes.html"><a href="el-bootstrap-en-la-estimacion-con-datos-dependientes.html#modelos-parametricos-de-dependencia-1"><i class="fa fa-check"></i><b>9.2.1</b> Modelos paramétricos de dependencia</a></li>
<li class="chapter" data-level="9.2.2" data-path="el-bootstrap-en-la-estimacion-con-datos-dependientes.html"><a href="el-bootstrap-en-la-estimacion-con-datos-dependientes.html#situaciones-de-dependencia-general-1"><i class="fa fa-check"></i><b>9.2.2</b> Situaciones de dependencia general</a></li>
<li class="chapter" data-level="9.2.3" data-path="el-bootstrap-en-la-estimacion-con-datos-dependientes.html"><a href="el-bootstrap-en-la-estimacion-con-datos-dependientes.html#el-bootstrap-por-bloques"><i class="fa fa-check"></i><b>9.2.3</b> El bootstrap por bloques</a></li>
<li class="chapter" data-level="9.2.4" data-path="el-bootstrap-en-la-estimacion-con-datos-dependientes.html"><a href="el-bootstrap-en-la-estimacion-con-datos-dependientes.html#eleccion-de-b"><i class="fa fa-check"></i><b>9.2.4</b> Elección de <span class="math inline">\(b\)</span></a></li>
<li class="chapter" data-level="9.2.5" data-path="el-bootstrap-en-la-estimacion-con-datos-dependientes.html"><a href="el-bootstrap-en-la-estimacion-con-datos-dependientes.html#el-bootstrap-estacionario"><i class="fa fa-check"></i><b>9.2.5</b> El bootstrap estacionario</a></li>
<li class="chapter" data-level="9.2.6" data-path="el-bootstrap-en-la-estimacion-con-datos-dependientes.html"><a href="el-bootstrap-en-la-estimacion-con-datos-dependientes.html#el-metodo-del-submuestreo"><i class="fa fa-check"></i><b>9.2.6</b> El método del submuestreo</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="el-bootstrap-para-la-prediccion-con-datos-dependientes.html"><a href="el-bootstrap-para-la-prediccion-con-datos-dependientes.html"><i class="fa fa-check"></i><b>9.3</b> El bootstrap para la predicción con datos dependientes</a><ul>
<li class="chapter" data-level="9.3.1" data-path="el-bootstrap-para-la-prediccion-con-datos-dependientes.html"><a href="el-bootstrap-para-la-prediccion-con-datos-dependientes.html#modelos-de-dependencia-parametrica"><i class="fa fa-check"></i><b>9.3.1</b> Modelos de dependencia paramétrica</a></li>
<li class="chapter" data-level="9.3.2" data-path="el-bootstrap-para-la-prediccion-con-datos-dependientes.html"><a href="el-bootstrap-para-la-prediccion-con-datos-dependientes.html#situaciones-de-dependencia-general-2"><i class="fa fa-check"></i><b>9.3.2</b> Situaciones de dependencia general</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="implementacion-en-r.html"><a href="implementacion-en-r.html"><i class="fa fa-check"></i><b>9.4</b> Implementación en <code>R</code></a></li>
<li class="chapter" data-level="9.5" data-path="implementacion-en-r-con-el-paquete-boot.html"><a href="implementacion-en-r-con-el-paquete-boot.html"><i class="fa fa-check"></i><b>9.5</b> Implementación en <code>R</code> con el paquete <code>boot</code></a><ul>
<li class="chapter" data-level="9.5.1" data-path="implementacion-en-r-con-el-paquete-boot.html"><a href="implementacion-en-r-con-el-paquete-boot.html#rnews-1"><i class="fa fa-check"></i><b>9.5.1</b> Rnews 1</a></li>
<li class="chapter" data-level="9.5.2" data-path="implementacion-en-r-con-el-paquete-boot.html"><a href="implementacion-en-r-con-el-paquete-boot.html#rnews-2"><i class="fa fa-check"></i><b>9.5.2</b> Rnews 2</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="ejercicios-1.html"><a href="ejercicios-1.html"><i class="fa fa-check"></i><b>9.6</b> Ejercicios</a></li>
<li class="chapter" data-level="9.7" data-path="implementacion-en-r-con-el-paquete-forecast.html"><a href="implementacion-en-r-con-el-paquete-forecast.html"><i class="fa fa-check"></i><b>9.7</b> Implementación en <code>R</code> con el paquete <code>forecast</code></a><ul>
<li class="chapter" data-level="9.7.1" data-path="implementacion-en-r-con-el-paquete-forecast.html"><a href="implementacion-en-r-con-el-paquete-forecast.html#bootstrap-condicional-a-partir-de-un-modelo-ajustado"><i class="fa fa-check"></i><b>9.7.1</b> Bootstrap condicional (a partir de un modelo ajustado)</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="spatial-data.html"><a href="spatial-data.html"><i class="fa fa-check"></i><b>9.8</b> Spatial data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="appendix"><span><b>Apendices</b></span></li>
<li class="chapter" data-level="A" data-path="links.html"><a href="links.html"><i class="fa fa-check"></i><b>A</b> Enlaces</a><ul>
<li class="chapter" data-level="A.1" data-path="forecast-links.html"><a href="forecast-links.html"><i class="fa fa-check"></i><b>A.1</b> Forecasting: Principles and Practice</a></li>
<li class="chapter" data-level="A.2" data-path="spatial-links.html"><a href="spatial-links.html"><i class="fa fa-check"></i><b>A.2</b> Spatial data</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Técnicas de Remuestreo</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="cap5_basic" class="section level2">
<h2><span class="header-section-number">5.2</span> Método percentil (básico)</h2>
<p>Este método se basa en la construcción del intervalo de confianza, mediante bootstrap, a partir del estadístico no estandarizado <span class="math display">\[R_2=\sqrt{n}\left( \hat{\theta}-\theta \right).\]</span> Una vez realizado el correspondiente remuestreo (uniforme, suavizado, simetrizado, …), a partir de cierto estimador, <span class="math inline">\(\hat{F}\,\)</span>, de la distribución poblacional, <span class="math inline">\(F\)</span>, la distribución en el muestreo de <span class="math inline">\(R_2\)</span> se aproxima mediante la distribución bootstrap de <span class="math display">\[R_2^{\ast}=\sqrt{n}\left( \hat{\theta}^{\ast}-\theta \left( \hat{F}
 \right) \right).\]</span> Así se obtienen valores <span class="math inline">\(x_{\alpha /2}\)</span> y <span class="math inline">\(x_{1-\alpha /2}\)</span>, siendo <span class="math inline">\(x_{\beta }\)</span>, tal que <span class="math inline">\(P^{\ast}\left( R_2^{\ast }\leq x_{\beta } \right) =\beta\)</span>, y a partir de ellos sabemos que <span class="math display">\[\begin{aligned}
1-\alpha &amp;= 1-\frac{\alpha }{2}-\frac{\alpha }{2}=P^{\ast}\left(
R_2^{\ast}&lt;x_{1-\alpha /2} \right) -P^{\ast}\left( R_2^{\ast}\leq
x_{\alpha /2} \right) \\
&amp;= P^{\ast}\left( x_{\alpha /2}&lt;R_2^{\ast}&lt;x_{1-\alpha /2} \right),
\end{aligned}\]</span> con lo cual decimos que también ha de ser aproximadamente igual a <span class="math inline">\(1-\alpha\)</span> la siguiente probabilidad<span class="math display">\[\begin{aligned}
P\left( x_{\alpha /2}&lt;R_2&lt;x_{1-\alpha /2} \right) &amp;= P\left( x_{\alpha /2}&lt;
\sqrt{n}\left( \hat{\theta}-\theta \right) &lt;x_{1-\alpha /2} \right) \\
&amp;= P\left( \hat{\theta}-\frac{x_{1-\alpha /2}}{\sqrt{n}}&lt;\theta &lt;\hat{\theta}
-\frac{x_{\alpha /2}}{\sqrt{n}} \right).\end{aligned}\]</span> Ello da pie a definir el intervalo de confianza bootstrap calculado por el método percentil como <span class="math display">\[\hat{I}_1=\left( \hat{\theta}-\frac{x_{1-\alpha /2}}{\sqrt{n}},\hat{\theta}
-\frac{x_{\alpha /2}}{\sqrt{n}} \right).\]</span></p>
<p>Para estudiar el error de cobertura de este intervalo de confianza conviene ver antes qué grado de aproximación existe entre la distribución en el muestreo de <span class="math inline">\(R_2\)</span> y la distribución bootstrap de <span class="math inline">\(R_2^{\ast}\)</span>. A partir del Teorema de Bhattacharya-Ghosh se tiene<span class="math display">\[\begin{aligned}
P\left( R_2\leq v \right) &amp;= P\left( \sqrt{n}\left( \hat{\theta}-\theta
 \right) \leq v \right) =P\left( \sqrt{n}\frac{\hat{\theta}-\theta }{\sigma
_{\theta }}\leq \frac{v}{\sigma _{\theta }} \right) \\
&amp;= \Phi \left( \frac{v}{\sigma _{\theta }} \right) +O\left( n^{-\frac{1}{2}
} \right) \\
P^{\ast}\left( R_2^{\ast}\leq v \right) &amp;= P^{\ast}\left( \sqrt{n}\left( 
\hat{\theta}^{\ast}-\theta \left( \hat{F} \right) \right) \leq v \right)
\\
&amp;=  P^{\ast}\left( \sqrt{n}\frac{\hat{\theta}^{\ast}-\theta \left( \hat{F}
 \right)}{\sigma _{\hat{\theta}}}\leq \frac{v}{\sigma _{\hat{\theta}}} \right)
=\Phi \left( \frac{v}{\sigma _{\hat{\theta}}} \right) +O_{P}\left( n^{-
\frac{1}{2}} \right).
\end{aligned}\]</span></p>
<p>Como consecuencia <span class="math display">\[P^{\ast}\left( R_2^{\ast}\leq v \right) -P\left( R_2\leq v \right) =\Phi
\left( \frac{v}{\sigma _{\hat{\theta}}} \right) -\Phi \left( \frac{v}{\sigma
_{\theta }} \right) +O_{P}\left( n^{-\frac{1}{2}} \right) =O_{P}\left( n^{-
\frac{1}{2}} \right),\]</span> ya que, típicamente, <span class="math inline">\(\sigma _{\hat{\theta}}-\sigma _{\theta} = O_{P}\left( n^{-\frac{1}{2}} \right)\)</span>. En resumen, la distribución en el muestreo de <span class="math inline">\(R_2\)</span> y la distribución bootstrap de <span class="math inline">\(R_2^{\ast}\)</span> se aproximan, una a la otra, a la velocidad <span class="math inline">\(O_{P}\left( n^{-\frac{1}{2} } \right)\)</span>, cuando <span class="math inline">\(n\rightarrow \infty\)</span>.</p>
<p>El error de cobertura del intervalo de confianza bilateral calculado mediante bootstrap por el método percentil es <span class="math display">\[\begin{aligned}
P\left( \theta \in \hat{I}_1 \right) -\left( 1-\alpha \right) =&amp;\ P\left(
R_2&lt;x_{1-\alpha /2} \right) -P\left( R_2\leq x_{\alpha /2} \right) \\
&amp;-\left[ P^{\ast}\left( R_2^{\ast}&lt;x_{1-\alpha /2} \right) -P^{\ast
}\left( R_2^{\ast}\leq x_{\alpha /2} \right) \right] \\
=&amp;\ P\left( R_2&lt;x_{1-\alpha /2} \right) -P^{\ast}\left( R_2^{\ast
}&lt;x_{1-\alpha /2} \right) \\
&amp;-\left[ P\left( R_2\leq x_{\alpha /2} \right) -P^{\ast}\left(
R_2^{\ast}\leq x_{\alpha /2} \right) \right] \\
=&amp;\ O_{P}\left( n^{-\frac{1}{2}} \right)
\end{aligned}\]</span></p>
<p>De esta forma el error de cobertura para los intervalos de confianza bilaterales bootstrap obtenidos mediante el método percentil es <span class="math inline">\(O\left( n^{-\frac{1}{2}} \right)\)</span>. Puede deducirse que ese es también el orden para los intervalos unilaterales obtenidos por este método. Así pues el orden del error de cobertura para el método percentil cuando se construyen intervalos de confianza unilaterales coincide con el de los construidos usando la normal asintótica pero el orden del error de cobertura de los intervalos bilaterales bootstrap constuidos por el método percentil es peor que el de los basados en la normal asintótica, que es del orden <span class="math inline">\(O\left( n^{-1} \right)\)</span>.</p>

<div class="example">
<p><span id="exm:media-dt-desconocida-perc" class="example"><strong>Ejemplo 5.1  (Inferencia sobre la media con varianza desconocida, continuación)  </strong></span><br> </p>
Continuando con el ejemplo de los tiempos de vida de microorganismos (sin asumir varianza conocida), supongamos que queremos obtener una estimación por intervalo de confianza de su vida media empleando este método. El código necesario sería muy similar al del Ejemplo <a href="calculo-de-la-distribucion-bootstrap-exacta-y-aproximada.html#exm:media-dt-desconocida">1.5</a>:
</div>

<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">muestra &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.143</span>, <span class="fl">0.182</span>, <span class="fl">0.256</span>, <span class="fl">0.26</span>, <span class="fl">0.27</span>, <span class="fl">0.437</span>, <span class="fl">0.509</span>, 
             <span class="fl">0.611</span>, <span class="fl">0.712</span>, <span class="fl">1.04</span>, <span class="fl">1.09</span>, <span class="fl">1.15</span>, <span class="fl">1.46</span>, <span class="fl">1.88</span>, <span class="fl">2.08</span>)
n &lt;-<span class="st"> </span><span class="kw">length</span>(muestra)
alfa &lt;-<span class="st"> </span><span class="fl">0.05</span>
x_barra &lt;-<span class="st"> </span><span class="kw">mean</span>(muestra)

<span class="co"># Remuestreo</span>
<span class="kw">set.seed</span>(<span class="dv">1</span>)
B &lt;-<span class="st"> </span><span class="dv">1000</span>
remuestra &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)
x_barra_boot &lt;-<span class="st"> </span><span class="kw">numeric</span>(B) 
estadistico_boot &lt;-<span class="st"> </span><span class="kw">numeric</span>(B)
<span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B) {
  remuestra &lt;-<span class="st"> </span><span class="kw">sample</span>(muestra, n, <span class="dt">replace =</span> <span class="ot">TRUE</span>)
  x_barra_boot[k] &lt;-<span class="st"> </span><span class="kw">mean</span>(remuestra)
  estadistico_boot[k] &lt;-<span class="st"> </span><span class="kw">sqrt</span>(n) <span class="op">*</span><span class="st"> </span>(x_barra_boot[k] <span class="op">-</span><span class="st"> </span>x_barra)
}

<span class="co"># Aproximación bootstrap de los ptos críticos</span>
pto_crit &lt;-<span class="st"> </span><span class="kw">quantile</span>(estadistico_boot, <span class="kw">c</span>(alfa<span class="op">/</span><span class="dv">2</span>, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alfa<span class="op">/</span><span class="dv">2</span>))

<span class="co"># Construcción del IC</span>
ic_inf_boot &lt;-<span class="st"> </span>x_barra <span class="op">-</span><span class="st"> </span>pto_crit[<span class="dv">2</span>]<span class="op">/</span><span class="kw">sqrt</span>(n)
ic_sup_boot &lt;-<span class="st"> </span>x_barra <span class="op">-</span><span class="st"> </span>pto_crit[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sqrt</span>(n)
IC_boot &lt;-<span class="st"> </span><span class="kw">c</span>(ic_inf_boot, ic_sup_boot)
<span class="kw">names</span>(IC_boot) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="dv">100</span><span class="op">*</span><span class="kw">c</span>(alfa<span class="op">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">-</span>alfa<span class="op">/</span><span class="dv">2</span>), <span class="st">&quot;%&quot;</span>)
IC_boot</code></pre></div>
<pre><code>##     2.5%    97.5% 
## 0.457700 1.092293</code></pre>
<p>Aunque en este caso también podemos obtener el intervalo a partir de las réplicas bootstrap del estimador:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pto_crit &lt;-<span class="st"> </span><span class="kw">quantile</span>(x_barra_boot, <span class="kw">c</span>(alfa<span class="op">/</span><span class="dv">2</span>, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alfa<span class="op">/</span><span class="dv">2</span>))
ic_inf_boot &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>x_barra <span class="op">-</span><span class="st"> </span>pto_crit[<span class="dv">2</span>]
ic_sup_boot &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>x_barra <span class="op">-</span><span class="st"> </span>pto_crit[<span class="dv">1</span>]
IC_boot &lt;-<span class="st"> </span><span class="kw">c</span>(ic_inf_boot, ic_sup_boot)
<span class="kw">names</span>(IC_boot) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="dv">100</span><span class="op">*</span><span class="kw">c</span>(alfa<span class="op">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">-</span>alfa<span class="op">/</span><span class="dv">2</span>), <span class="st">&quot;%&quot;</span>)
IC_boot</code></pre></div>
<pre><code>##     2.5%    97.5% 
## 0.457700 1.092293</code></pre>
<p>Esta forma de proceder es la que emplea el paquete <code>boot</code> para obtener el que denomina intervalo de confianza <em>bootstrap básico</em> (estableciendo <code>type=&quot;basic&quot;</code> en la llamada a la función <code>boot.ci()</code>):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(boot)
statistic &lt;-<span class="st"> </span><span class="cf">function</span>(data, i) <span class="kw">mean</span>(data[i])

<span class="kw">set.seed</span>(<span class="dv">1</span>)
res.boot &lt;-<span class="st"> </span><span class="kw">boot</span>(muestra, statistic, <span class="dt">R =</span> <span class="dv">1000</span>)
res &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(res.boot, <span class="dt">type =</span> <span class="st">&quot;basic&quot;</span>)
res</code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 1000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = res.boot, type = &quot;basic&quot;)
## 
## Intervals : 
## Level      Basic         
## 95%   ( 0.4945,  1.1121 )  
## Calculations and Intervals on Original Scale</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">IC_boot &lt;-<span class="st"> </span>res<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]
IC_boot</code></pre></div>
<pre><code>## [1] 0.494535 1.112066</code></pre>
<p>Además del paquete <code>boot</code>, otros autores también denominan a este método <em>bootstrap básico</em> (<em>bootstrap percentil básico</em> o incluso <em>bootstrap natural</em>), y utilizan la terminología <em>bootstrap percentil</em> cuando se emplea directamente el estimador como estadístico (<span class="math inline">\(R = \hat \theta\)</span>) para realizar inferencia. Con el paquete <code>boot</code> habrá que establecer <code>type=&quot;perc&quot;</code> en la llamada a la función <code>boot.ci()</code> para obtener el intervalo correspondiente:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boot.ci</span>(res.boot, <span class="dt">type =</span> <span class="st">&quot;perc&quot;</span>)</code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 1000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = res.boot, type = &quot;perc&quot;)
## 
## Intervals : 
## Level     Percentile     
## 95%   ( 0.4986,  1.1161 )  
## Calculations and Intervals on Original Scale</code></pre>
<p>En este método se emplean directamente los cuantiles de las réplicas bootstrap del estadístico:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># IC_boot &lt;-  quantile(res.boot$t, c(alfa/2, 1 - alfa/2)) # type = 7</span>
IC_boot &lt;-<span class="st">  </span><span class="kw">quantile</span>(res.boot<span class="op">$</span>t, <span class="kw">c</span>(alfa<span class="op">/</span><span class="dv">2</span>, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alfa<span class="op">/</span><span class="dv">2</span>), <span class="dt">type =</span> <span class="dv">6</span>)
IC_boot </code></pre></div>
<pre><code>##      2.5%     97.5% 
## 0.4985983 1.1161317</code></pre>
<p>Asintóticamente ambos métodos son equivalentes, aunque en general es preferible (evita sesgos) el bootstrap percentil básico.</p>
<!-- 
ejercicio 
Obtener los ICs mediante los método básico y percentil
de la varianza y cuasivarianza muestrales.

Recorrido intercuartílico?
-->
</div>
            </section>

          </div>
        </div>
      </div>
<a href="cap5-norm.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="cap5-perc-t.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rubenfcasal/book_remuestreo/edit/master/05-ic_boot.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["book_remuestreo.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
